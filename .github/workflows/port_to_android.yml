name: Fix SFML Vector2 Dependency

on:
  workflow_dispatch:

permissions:
  contents: write

jobs:
  fix-code:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Rewrite Vector2.hpp without SFML
        run: |
          # Sobrescreve o arquivo Vector2.hpp com uma vers√£o pura C++
          cat <<EOF > app/src/main/cpp/sources/Models/Vector2.hpp
          #pragma once

          #include <ostream>

          namespace ComSquare
          {
              template<typename T>
              class Vector2
              {
              public:
                  T x;
                  T y;

                  Vector2() : x(0), y(0) {}

                  Vector2(T _x, T _y) : x(_x), y(_y) {}

                  // Construtor SFML removido para compatibilidade com Android

                  template<typename T2>
                  Vector2<T> &operator+=(const Vector2<T2> &vec)
                  {
                      this->x += vec.x;
                      this->y += vec.y;
                      return *this;
                  }

                  template<typename T2>
                  Vector2<T> operator+(const Vector2<T2> &vec) const
                  {
                      return Vector2<T>(this->x + vec.x, this->y + vec.y);
                  }

                  template<typename T2>
                  Vector2<T> &operator-=(const Vector2<T2> &vec)
                  {
                      this->x -= vec.x;
                      this->y -= vec.y;
                      return *this;
                  }

                  template<typename T2>
                  Vector2<T> operator-(const Vector2<T2> &vec) const
                  {
                      return Vector2<T>(this->x - vec.x, this->y - vec.y);
                  }

                  template<typename T2>
                  Vector2<T> &operator*=(T2 d)
                  {
                      this->x *= d;
                      this->y *= d;
                      return *this;
                  }

                  template<typename T2>
                  Vector2<T> operator*(T2 d) const
                  {
                      return Vector2<T>(this->x * d, this->y * d);
                  }

                  template<typename T2>
                  T operator*(Vector2<T> &b) const
                  {
                      return this->x * b.x + this->y * b.y;
                  }

                  template<typename T2>
                  Vector2<T> operator/=(Vector2<T2> &b)
                  {
                      this->x /= b.x;
                      this->y /= b.y;
                      return this;
                  }

                  template<typename T2>
                  Vector2<T> operator/(Vector2<T2> &b) const
                  {
                      return Vector2<T>(this->x / b.x, this->y / b.y);
                  }

                  template<typename T2>
                  Vector2<T> operator/=(T2 b)
                  {
                      this->x /= b;
                      this->y /= b;
                      return this;
                  }

                  template<typename T2>
                  Vector2<T> operator/(T2 b) const
                  {
                      return Vector2<T>(this->x / b, this->y / b);
                  }
              };

              typedef Vector2<float> Vector2f;
              typedef Vector2<unsigned> Vector2u;
              typedef Vector2<int> Vector2i;
          }

          template<typename T>
          std::ostream &operator<<(std::ostream &s, const ComSquare::Vector2<T> &v)
          {
              s << v.x << " " << v.y;
              return s;
          }
          EOF

      - name: Commit and Push changes
        run: |
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"
          git add app/src/main/cpp/sources/Models/Vector2.hpp
          git commit -m "Fix: Remove SFML dependency from Vector2.hpp for Android build"
          git push
